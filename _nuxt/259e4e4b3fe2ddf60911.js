(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{230:function(e,t,n){"use strict";n.r(t);n(13),n(41),n(39),n(40);var r=n(28),o={data:function(){return{dialog:!1,search:"",headers:[{text:"ID",align:"left",value:"id"},{text:"Name",align:"left",value:"role"},{text:"Permissions",align:"left",value:"permissions"},{text:"Actions",align:"left",value:"name",sortable:!1}],usersRoles:[],permissions:[],editedIndex:-1,editedItem:{id:0,permissions:[],role:""},defaultItem:{id:0,permissions:[],role:""},permissionGroup:{},warningMessage:""}},computed:{formTitle:function(){return-1===this.editedIndex?"New Role":"Edit role"},role:function(){return this.$store.getters.role}},watch:{dialog:function(e){e||this.close()}},created:function(){var e=localStorage.getItem("permissions");""!=e&&(this.permissionGroup=JSON.parse(e)),this.isPermissionAllowed("GET_ROLES")||this.$router.push("/home"),this.initialize(),this.getPermissions()},methods:{isPermissionAllowed:function(e){if(this.permissionGroup!={})for(var t=this.permissionGroup.permissions,n=0;n<t.length;n++){if(t[n].name.includes(e))return!0}return!1},getPermissionsText:function(e){var t="";return e.forEach((function(element){""!=t&&(t+=", "),t+=element.name})),t.length>50?t.slice(0,50)+"...":t},initialize:function(){var e=this;this.usersRoles=[];var t=localStorage.getItem("token");r.a.defaults.headers.common.Authorization="Bearer "+t,this.warningMessage="Loading...",r.a.get("roles?page=0&size=100").then((function(t){e.usersRoles=t.data.data})).catch((function(e){})).finally((function(){e.warningMessage="There is no users roles yet in the system"}))},getPermissions:function(){var e=this;r.a.get("permissions").then((function(t){e.permissions=t.data})).catch((function(e){}))},editItem:function(e){this.editedIndex=this.usersRoles.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem:function(e){var t=this,n=this.usersRoles.indexOf(e);confirm("Are you sure you want to delete this item?")&&r.a.delete("roles/"+e.id).then((function(){t.usersRoles.splice(n,1)}))},close:function(){var e=this;this.dialog=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},save:function(){var e=this;if(this.editedIndex>-1){var t=this.permissions.filter((function(t){return e.editedItem.permissions.includes(t.id)}));r.a.put("roles/"+this.editedItem.id,{id:this.editedItem.id,role:this.editedItem.role,permissions:t.length>0?t:this.editedItem.permissions}).then((function(t){e.initialize()}))}else{if(""===this.editedItem.role)return void alert("Please enter a role");if(this.editedItem.permissions.length<1)return void alert("Please choose some permissions to continue");r.a.post("roles",{id:0,role:this.editedItem.role,permissions:this.permissions.filter((function(t){return e.editedItem.permissions.includes(t.id)}))}).then((function(t){e.initialize()}))}this.close()}}},l=n(9),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-toolbar-title",[e._v("Users Roles Table")]),e._v(" "),n("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),e._v(" "),n("v-spacer"),e._v(" "),n("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([e.isPermissionAllowed("CREATE_ROLE")?{key:"activator",fn:function(t){var r=t.on;return[n("v-spacer"),e._v(" "),n("v-btn",e._g({staticClass:"mb-2",attrs:{color:"primary",dark:""}},r),[e._v("Add Role")])]}}:null],null,!0),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),n("v-card-text",[n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{label:"Role name"},model:{value:e.editedItem.role,callback:function(t){e.$set(e.editedItem,"role",t)},expression:"editedItem.role"}})],1),e._v(" "),n("v-flex",{attrs:{xs12:""}},[n("v-select",{attrs:{multiple:"",chips:"","item-text":"name","item-value":"id",items:e.permissions,label:"Permissions"},model:{value:e.editedItem.permissions,callback:function(t){e.$set(e.editedItem,"permissions",t)},expression:"editedItem.permissions"}})],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:e.close}},[e._v("Cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:e.save}},[e._v("Save")])],1)],1)],1)],1),e._v(" "),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.usersRoles,search:e.search},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",{staticClass:"text-xs-left"},[e._v(e._s(t.item.id))]),e._v(" "),n("td",{staticClass:"text-xs-left"},[e._v(e._s(t.item.role))]),e._v(" "),n("td",{staticClass:"text-xs-left"},[e._v("\n        "+e._s(e.getPermissionsText(t.item.permissions))+"\n      ")]),e._v(" "),e.isPermissionAllowed("UPDATE_ROLE")||e.isPermissionAllowed("DELETE_ROLE")?n("td",{staticClass:"text-xs-left"},[e.isPermissionAllowed("UPDATE_ROLE")?n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(n){return e.editItem(t.item)}}},[e._v("edit")]):e._e(),e._v(" "),e.isPermissionAllowed("DELETE_ROLE")?n("v-icon",{attrs:{small:""},on:{click:function(n){return e.deleteItem(t.item)}}},[e._v("delete")]):e._e()],1):e._e()]}},{key:"no-data",fn:function(){return[n("v-alert",{attrs:{value:!0,color:"#22B9B1",icon:"warning"}},[e._v(e._s(e.warningMessage))])]},proxy:!0},{key:"no-results",fn:function(){return[n("v-alert",{attrs:{value:!0,color:"#22B9B1",icon:"info"}},[e._v('Your search for "'+e._s(e.search)+'" found no results.')])]},proxy:!0}])})],1)}),[],!1,null,"077e7d02",null);t.default=component.exports}}]);